# BPM Sync Visualizer 使用ガイド（日本語）

## 概要

BPM Sync Visualizer は、音楽ファイルの波形を表示し、設定したBPMに完全に同期したUIフラッシュを提供するアプリケーションです。DJやライブパフォーマンス、音楽制作での使用を想定して設計されています。

## 基本操作

### 1. アプリケーションの起動

```bash
dotnet run
```

メインウィンドウが開き、以下の要素が表示されます：
- ファイルドロップエリア（上部）
- 波形表示エリア（中央）
- コントロールパネル（下部）
- ステータスバー（最下部）

### 2. オーディオファイルの読み込み

**方法A: ドラッグ&ドロップ**
1. mp3またはwavファイルをファイルドロップエリアにドラッグ
2. ファイルを離すと自動的に読み込み開始
3. 波形が表示されれば読み込み完了

**方法B: ファイル選択ダイアログ**
1. 「ファイル選択」ボタンをクリック
2. ファイル選択ダイアログで目的のファイルを選択
3. 「開く」をクリックして読み込み

**対応ファイル形式**
- MP3 (.mp3)
- WAV (.wav)

### 3. 再生開始位置の設定

1. 波形表示エリア内の任意の位置をクリック
2. 赤いマーカーが設定位置に移動
3. 下部の「開始時間」表示が更新される
4. マウスホバーで時間のツールチップが表示

**ヒント**
- 楽曲の1拍目に合わせて開始位置を設定することを推奨
- 細かい調整は波形を見ながら行う

### 4. BPMの設定

1. BPM入力フィールドに値を入力
2. 設定可能範囲：30.0～300.0
3. 小数点以下1桁まで入力可能（例：120.5）
4. 無効な値を入力するとエラーメッセージが表示

**BPM検出のヒント**
- 楽曲のBPMは楽曲情報や音楽制作ソフトで確認
- 手動カウントの場合：15秒間のビート数×4

### 5. 同期再生の開始

1. 「再生」ボタンをクリック
2. 設定した開始位置から音声再生が始まる
3. 同時にUIが設定BPMに合わせてフラッシュ開始
4. 黄色いマーカーが現在の再生位置を示す

**フラッシュの仕様**
- 黒→白→黒→白の繰り返し
- 1フラッシュ = 1ビート
- ±10ms以下の精度で同期

### 6. 再生の停止

1. 「停止」ボタンをクリック
2. 音声再生とUIフラッシュが即座に停止
3. 画面が通常の状態に戻る
4. 次回再生時は同じ設定で再開可能

## 詳細機能

### 波形表示の活用

**視覚的な分析**
- 緑色の波形で音楽の強弱を確認
- ビートの位置を視覚的に特定
- 楽曲構造（イントロ、サビなど）の把握

**インタラクティブ操作**
- クリック：開始位置設定
- ホバー：時間表示
- 赤マーカー：設定した開始位置
- 黄マーカー：現在の再生位置

### BPM同期の精度管理

**自動補正機能**
- 再生中に音声とUIの同期ずれを監視
- 10ms以上のずれを検出すると自動補正
- 長時間再生でも精度を維持

**パフォーマンス最適化**
- バックグラウンドでの音声処理
- UIスレッドをブロックしない設計
- メモリ使用量の最適化

## エラーハンドリングと対処法

### よくあるエラーと解決方法

**「ファイル読み込みエラー」**
- 原因：破損したファイル、対応外フォーマット、権限不足
- 対処：別のファイルを試す、ファイル権限を確認

**「BPMは30から300の間で入力してください」**
- 原因：BPM値が範囲外
- 対処：30.0～300.0の範囲で再入力

**「mp3またはwavファイルのみサポートしています」**
- 原因：対応外のファイル形式
- 対処：mp3またはwav形式に変換してから使用

**「再生エラー」**
- 原因：オーディオドライバの問題、リソース不足
- 対処：アプリケーション再起動、他のオーディオアプリ終了

### トラブルシューティング

**同期がずれる場合**
1. アプリケーションを再起動
2. BPM値を再設定
3. 開始位置を正確に設定し直し
4. システムの負荷を下げる

**フラッシュが見えない場合**
- 画面の明度設定を確認
- 全画面表示を試す
- 他のアプリケーションを最小化

## キーボードショートカット

現在の実装では以下のキーボード操作に対応：

- **Tab**: コントロール間の移動
- **Enter**: 数値入力の確定
- **Esc**: ダイアログの閉じる

## パフォーマンスとシステム要件

### 推奨環境
- CPU：デュアルコア以上
- RAM：8GB以上
- ストレージ：SSD推奨（高速ファイル読み込み）

### パフォーマンス指標
- 起動時間：2秒以下
- ファイル読み込み：10分のwavファイルで30秒以下
- メモリ使用量：300MB以下（10分音源）
- 同期精度：±10ms以下

## 使用例とベストプラクティス

### DJユース
1. 楽曲のBPMを事前調査
2. ビートドロップ位置を開始点に設定
3. 他の楽曲とのBPMマッチング確認

### ライブパフォーマンス
1. リハーサルで各楽曲の設定を確認
2. バックアップ用のオーディオファイル準備
3. システムの安定性テスト実施

### 音楽制作
1. 楽曲のリズムパターン分析
2. テンポチェンジ箇所の特定
3. ミックスダウン時の参考データとして活用

## アクセシビリティ機能

- **色覚対応**：黒白フラッシュで色覚に依存しない表示
- **キーボードナビゲーション**：マウス無しでも操作可能
- **大きなUI要素**：クリックしやすいボタンサイズ
- **明確なフィードバック**：操作結果の分かりやすい表示

## 今後の拡張予定

- カスタムフラッシュカラー
- MIDI出力対応
- 自動BPM検出
- プレイリスト機能
- ビート細分化（1/2、1/4拍対応）

## サポートとフィードバック

技術的な質問やバグレポートは、GitHubのIssuesページへお願いします。

## 関連ドキュメント

- [README.md](../README.md)：プロジェクト概要と開発情報
- [HowToCustomizeFlashColors_ja.md](HowToCustomizeFlashColors_ja.md)：フラッシュカスタマイズガイド（将来実装予定）
